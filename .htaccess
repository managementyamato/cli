# XSERVERデプロイ用 .htaccess
# ※XserverはCGI版PHPのため、php_flag/php_valueは使用不可
# PHP設定は php.ini または .user.ini で行う

# ディレクトリインデックス
DirectoryIndex index.php

# セキュリティ: 特定のファイルへのアクセスを禁止
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

<FilesMatch "\.(json|md|sh|bat|ps1|dll|exe|ini)$">
    Require all denied
</FilesMatch>

# データディレクトリの保護
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteRule ^data/ - [F,L]
    RewriteRule ^config/ - [F,L]
    RewriteRule ^tmp/ - [F,L]
</IfModule>

# HTTPS強制
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
</IfModule>

# セキュリティヘッダー
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# バックアップファイルへのアクセスを禁止
<FilesMatch "\.(bak|orig|old|save|tmp)$">
    Require all denied
</FilesMatch>
